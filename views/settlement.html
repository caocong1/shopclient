<div class="row">
    <div class="col-md-offset-2 col-md-8 mdcol-sm-offset-1 col-sm-10 col-xs-12">
        <div class="tabbable">
            <ul class="nav nav-tabs">
                <li class="active">
                    <a data-toggle="tab" href="#unsettlementdoc">
                        <i class="blue ace-icon fa fa-calendar-check-o bigger-120"></i>
                        异常结算单
                        <span class="badge badge-warning">2</span>
                    </a>
                </li>
                <li>
                    <a data-toggle="tab" href="#settlementdoc">
                        <i class="blue ace-icon fa fa-calendar bigger-120"></i>
                        结算单
                    </a>
                </li>
            </ul>
            <div class="tab-content no-border no-padding">
                <div id="unsettlementdoc" class="tab-pane fade in active">
                    <table id="unsettlementable"></table>
                </div>
                <div id="settlementdoc" class="tab-pane fade in">
                    <table id="settlementable"></table>
                </div>
            </div>
        </div>
    </div>
</div>
<!--toolbar-->
<div id="unsettletoolbar">
    <span id="unsettletoolbartitle" class="bootstraptable-title bigger-120">
        <i class="fa fa-table"></i>
            异常结算单列表
    </span>
    <button class="btn btn-primary btn-xs" type="button" name="refresh" title="刷新">
        <i class="ace-icon fa fa-refresh icon-only"></i>刷新
    </button>
</div>
<div id="settletoolbar">
    <span id="settletoolbartitle" class="bootstraptable-title bigger-120">
        <i class="fa fa-table"></i>
            结算单列表
    </span>
    <div class="col-sm-3 col-sm-offset-8">
                        <!--<span class="">-->
                    <!--选择日期：-->
                <!--</span>-->
        <div class="input-group date">
            <input class="form-control monthpicker" type="text" value="2017-06" readonly/>
            <span class="input-group-addon">
                <i class="fa fa-calendar"></i>
            </span>
        </div>
    </div>
    <button class="btn btn-primary btn-xs" type="button" name="refresh" title="刷新">
        <i class="ace-icon fa fa-refresh icon-only"></i>刷新
    </button>
</div>
<!--预览模态框-->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">单据预览</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-10">
                        <div class="docpreview">
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <button id="savepdf" class="btn btn-primary btn-xs" type="button">
                            <i class="ace-icon fa fa-download icon-only"></i>下载
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<button id="modalbutton" type="button" class="btn btn-primary" data-toggle="modal" data-target=".bs-example-modal-lg">
    Large modal
</button>

<!--<script src="../js/jspdf.min.js"></script>
<script src="../js/html2canvas.js"></script>-->
<script type="text/javascript">
	$("#savepdf").click(function(){
		var pdf = new jsPDF('p', 'pt', 'a4');
		$("body").append("<div id='temp' style='position:absolute;left:1600px;'>test</div>");
		$("#temp").append($(".docpreview").clone());
		pdf.addHTML($(".docpreview:eq(1)"),26,30,function(){
			pdf.save();
			$(".docpreview:eq(1)").remove();
		});
	});
    $("#modalbutton").click(function () {
        var html;
        $.ajax({
           url:"attachment/settlement/2.html",
            success:function(data){
                $(".docpreview").html(data)
            }
        });
    });
    $(".monthpicker").datetimepicker({
        language:"zh-CN",
        format:"yyyy-mm",
        startView: "year",
        minView:"year",
        autoclose:true
    });
    var settlementdoc = $("#settlementdoc");
    var settlementable = $("#settlementable");
    var unsettlementdoc = $("#unsettlementdoc");
    var unsettlementable = $("#unsettlementable");
    unsettlementable.bootstrapTable("destroy").bootstrapTable({
        url: "json/unsettlement.json",
        striped: true,
        pagination: true,
        paginationLoop: true,
        sidePagination:	'client',
        pageSize:"12",
        pageList:[15,25,50],
        uniqueId: "id",
        showRefresh: true,
        toolbar: '#unsettletoolbar',
        toolbarAlign: "right",
//        detailView:true,
//        detailFormatter:unsettlementdetail,
        iconsPrefix: 'fa',
        icons:{
            detailOpen: 'fa-plus-square-o',
            detailClose: 'fa-minus-square-o'
        },
        columns: [{
            field: "remindercode",
            title: "单号",
//            width:"160px"
        }, {
            field: "type",
            title: "异常类型",
//            width:"15%"
        }, {
            field: "createtime",
            title: "生成时间"
        }, {
            field: "ssettlement",
            title: "关联结算单",
            formatter:function (value,row,index) {
                return "<i class=\"fa fa-file-text-o\"></i>"
            }
        }],
        onLoadSuccess:function () {
            unsettlementdoc.find(".fixed-table-toolbar").append($("#unsettletoolbartitle"));
            unsettlementdoc.find(".columns-right").remove();
        }
    });
    settlementable.bootstrapTable("destroy").bootstrapTable({
        url: "json/settlement201708.json",
        striped: true,
        pagination: true,
        paginationLoop: true,
        sidePagination:	'client',
        pageSize:"12",
        pageList:[15,25,50],
        uniqueId: "id",
        showRefresh: true,
        toolbar: '#settletoolbar',
        toolbarAlign: "right",
//        detailView:true,
//        detailFormatter:settlementdetail,
        iconsPrefix: 'fa',
        icons:{
            detailOpen: 'fa-plus-square-o',
            detailClose: 'fa-minus-square-o'
        },
        columns: [{
            field: "settlementcode",
            title: "结算单号"
//            width:"160px"
        }, {
            field: "type",
            title: "结算类型"
//            width:"15%"
        }, {
            field: "createtime",
            title: "结算单生成时间"
        }, {
            field: "status",
            title: "结算单状态",
            formatter:function (value,row,index) {
                var label,status;
                if(value===1){
                    label = "label-info";
                    status = "结算中"
                }else if(value===2){
                    label = "label-warning";
                    status = "催缴"
                }else if(value===3){
                    label = "label-danger";
                    status = "滞纳"
                }else if(value===4){
                    label = "label-success";
                    status = "核销"
                }
                return "<span class=\"label " + label + " arrowed\">" + status + "</span>"
            }
        }],
        onClickRow:function (row,$element) {
            tableclickexpand(settlementable,$element)
        },
        onLoadSuccess:function () {
            settlementdoc.find(".fixed-table-toolbar").append($("#settletoolbartitle"));
            settlementdoc.find(".columns-right").remove();
        }
    });
    function settlementdetail() {

    }
    function updateunread() {
        var unread = messagelist.find(".message-unread").length;
        $("#id-message-infobar").find(".unread").text(unread);
    }

</script>